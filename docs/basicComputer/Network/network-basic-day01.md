---
autoGroup-1: 网络基础
sidebarDepth: 3
title: DNS解析/三次握手 
---

## 浏览器请求一个网页的流程
 <img :src="$withBase('/basicComputer/Network/web-request-process.png')" alt="web-request-process"> 

## URI
1. `URI`：`Uniform Resource Identifier`，即同一资源标识符，用来唯一的标识一个资源。
2. `URL`：`Uniform Resource Locator`，统一资源定位符。`URL`可以用来标识一个资源，而且还指明了如何定位这个资源用地址定义一个资源。
3. `URN`：`Uniform Resource Name`，统一资源命名。即通过名字来表示资源。用名称定位一个资源。
   
`URL`肯定是一个`URI`，`URI`并不一定是`URL`，也有可能是`URN`。三者关系如下图：
 <img :src="$withBase('/basicComputer/Network/uri-url-urn.png')" alt="uri-url-urn"> 


`URI`只是资源标识。   
`URL`：
- 1. 资源标识。
- 2. 具有定位资源的功能（资源的具体位置）
- 3. 指明了获取资源所采用的协议
   协议名称+主机名称+端口号+路径+文件+查询所需字符串。`https`默认端口号`443`，`http`默认端口号`80`。
     
`URN`: 主机名称+端口号+路径+文件+查询所需字符串。
表示资源的总称就是`URI`，具体定位某个资源的位置就是`URL`，一个资源是什么的时候就是`URN`。  

## 客户端与服务端
客户端：`Client`，客户所使用的电脑中的应用程序。
服务端：`Server`，存放网页、客户端程序、数据处理程序、数据库的电脑。

## 域名
域名（`Domain Name`）：
1. 相当于访问互联网某一户人家的地址
2. 域名与服务器绑定`UI`后，域名与服务器对应的`IP`是映射关系
3. 域名比`IP`方便记忆
4. `IP`可以对应多个域名，所以不同的域名可以访问一个或多个`WEB`网页


## DSN解析
`DNS`（`Domain Name Server`）域名服务器。  
作用：域名与对应的`IP`转换的服务器。   
特征：`DNS`中保存了一张域名与对应的`IP`地址的表。一个域名对应一个`IP`地址，一个`IP`地址可以对应多个域名。   
`gTLD`：`generic Top-Level DNS Serve`顶级域名服务器。为所有`com`、`net`...后缀做域名解析的服务器。

`DNS`解析流程：
 <img :src="$withBase('/basicComputer/Network/DNS.png')" alt="DNS"> 
地址栏输入网址之后，敲回车， 
1. 向**本地DNS解析器**查询是否存在baidu.com的ip，如果有，取本地缓存。如果没有，则向DNS根服务器查询。
2. DNS本地服务器向**根服务器**（美国有1个主的，9个辅的，英国瑞典日本各1个辅的）发起DNS解析请求，根域名服务器返回顶级域名服务器地址（.com或者.cn或者其他），同时DNS本地服务器会将顶级域名服务器地址缓存起来。
3. 向**com域服务器**发起解析请求。基本上不会找到，因为它仅仅只解析了一部分.com的域名，主要是做管理用的。得到baidu.com二级域名服务器地址。
4. 向**baidu.com域服务器**发起解析请求，这个时候会有两种情况：第一种情况是，DNS本地服务器没有baidu.com的域服务器地址；第二种是存的有baidu.com的域服务器。一般来说，在DNS本地服务器中，只要是.com的，对应的服务器运行商的IP地址都可能有。

## IP地址
`IP`端口号`PORT`：每一个端口对应的是一个服务器的一个业务，访问一个服务器的不同端口相当于访问不同的业务。   
端口号范围：`0 - 65535`   
默认端口：`http`协议下（`80`）、`https`协议下（`443`）、`FTP`协议下（`20`、`21`）    
`node`展示端口不同，服务端不同的业务。     


## TCP
`TCP`（`Transmission Control Protocol`）传输控制协议。  
特点：面向连接（收发数据前，必须建立可靠的连接）。   
建立连接基础：三次握手。   
应用场景：数据必须准确无误的收发   
- `HTTP`请求
- `FTP`文件传输
- 邮件收发

优点：稳定、重传机制、拥塞控制机制。
缺点：速度慢、效率低、占用资源、容易被攻击（三次握手-> `DOS`, `DDOS`攻击）

`TCP/IP`协议组：提供点对点的连接机制，制定了数据封装、定址、传输、路由、数据接受的标准。

## UDP
`UDP`（`User Data Protocol`）用户数据协议   
特点：无连接（不可靠的协议，无状态传输机制）。无连接信息发送机制。  
应用场景：无需确保通讯质量且要求速度快、无需确保信息完整。   
- 消息收发
- 语音通话
- 直播（QQ）

优点：安全、快速、漏洞少（`UDP flood`攻击）。
缺点：不可靠、不稳定、容易丢包。  


## 三次握手
标志位：数据包
- `SYN`：`Synchronize Sequence Numbers`同步序列编号
- `ACK`：`Achnowledgment` 确认字符

状态：  
- `LISTEN`：侦听`TCP`端口的连接请求（我等着你发送连接请求呢）
- `SYN-SENT`：在发送连接请求后等待匹配的连接请求（我发送了连接请求，我等你回复哈）
- `SYN-RECEIVED`：在收到和发送一个连接请求后等待对连接请求的确认（我收到你的连接请求了哈，我等你回复我）
- `ESTABLISHED`：代表一个打开的连接，数据可以传送给用户（建立连接了哈，我跟你说一下）

三次握手流程：
 <img :src="$withBase('/basicComputer/Network/three-times-handshake.png')" alt="three-times-handshake">    
第一次握手：客户端向服务器发送`SYN`标志位（序号是`J`），并进入`SYN_SEND`状态（等待服务器确认状态）。    
第二次握手：服务器收到来自客户端的`SYN J`，服务端会确认该数据包已收到并发送`ACK`标志位（序号是`J+1`）和`SYN`标志位（序号是`K`），服务器进入`SYN_REVD`（请求接受并等待客户端确认状态）。    
第三次握手：客户端进入连接建立状态后，向服务端发送`ACK`标志位（序号是`K+1`）确认客户端已收到建立连接确认，服务端收到`ACK`标志位后，服务端进入连接已建立状态。



